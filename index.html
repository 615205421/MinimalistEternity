<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>零刻</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;line-height:1.6;background:#fff;color:#000;min-height:100vh;padding:20px}.container{max-width:1200px;margin:0 auto}header{text-align:center;margin-bottom:30px;color:#000}header h1{font-size:2rem;margin-bottom:10px;font-weight:600}header p{font-size:1rem;opacity:0.8}.app-container{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:30px}@media(max-width:768px){.app-container{grid-template-columns:1fr}}.panel{background:#f8f9fa;border-radius:8px;padding:20px;border:1px solid #dee2e6}.panel h2{color:#000;margin-bottom:15px;padding-bottom:8px;border-bottom:2px solid #000;font-size:1.3rem}.upload-area{border:2px dashed #adb5bd;border-radius:6px;padding:30px 15px;text-align:center;cursor:pointer;margin-bottom:15px}.upload-area:hover{border-color:#000}.upload-area i{font-size:36px;color:#000;margin-bottom:10px}.upload-area h3{color:#000;margin-bottom:8px}.upload-area p{color:#6c757d;font-size:0.85rem}.file-input{display:none}textarea{width:100%;min-height:250px;padding:12px;border:1px solid #ced4da;border-radius:5px;font-family:system-ui,monospace;font-size:14px;resize:vertical;background:#fff}textarea:focus{outline:none;border-color:#000}.control-panel{display:flex;gap:10px;flex-wrap:wrap;margin-top:15px}.config-section{margin-top:20px;padding-top:15px;border-top:1px solid #dee2e6}.config-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin-top:10px}.config-item{display:flex;flex-direction:column;gap:4px}.config-item label{font-weight:500;color:#000;font-size:0.85rem}.config-item input{padding:6px 10px;border:1px solid #ced4da;border-radius:4px;font-size:14px}.config-item input:focus{outline:none;border-color:#000}.btn{padding:10px 20px;border:none;border-radius:5px;font-weight:500;font-size:0.9rem;cursor:pointer;display:inline-flex;align-items:center;gap:6px;transition:all 0.2s}.btn-primary{background:#000;color:#fff}.btn-primary:hover{background:#333}.btn-secondary{background:#e9ecef;color:#000}.btn-secondary:hover{background:#dee2e6}.btn-success{background:#212529;color:#fff}.btn-success:hover{background:#495057}.preview-area{max-height:300px;overflow-y:auto;background:#fff;border-radius:5px;padding:12px;margin-top:15px;border:1px solid #dee2e6}.preview-area pre{font-family:system-ui,monospace;font-size:12px;line-height:1.4;white-space:pre-wrap;word-wrap:break-word;margin:0}.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin-top:15px;padding:12px;background:#e9ecef;border-radius:5px}.stat-item{text-align:center}.stat-value{font-size:1.2rem;font-weight:600;color:#000}.stat-label{font-size:0.8rem;color:#6c757d;margin-top:3px}.notification{position:fixed;bottom:15px;right:15px;padding:12px 20px;border-radius:5px;background:#fff;box-shadow:0 3px 10px rgba(0,0,0,0.2);display:flex;align-items:center;gap:8px;transform:translateX(150%);transition:transform 0.3s;z-index:1000;border-left:3px solid #000}.notification.show{transform:translateX(0)}.footer{text-align:center;margin-top:30px;color:#6c757d;opacity:0.8;font-size:0.85rem}.loading{display:none;text-align:center;padding:15px}.loading.spinner{width:30px;height:30px;border:3px solid #f3f3f3;border-top:3px solid #000;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 10px}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.how-to-use{background:#f8f9fa;border-radius:8px;padding:20px;margin-top:25px;border:1px solid #dee2e6}.how-to-use h3{color:#000;margin-bottom:15px}.how-to-use ol{padding-left:20px;margin-bottom:15px}.how-to-use li{margin-bottom:8px;color:#000}.sample-format{background:#e9ecef;padding:12px;border-radius:5px;margin-top:15px;font-family:system-ui,monospace;font-size:11px}#previewModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:2000;align-items:center;justify-content:center}.modal-content{background:#fff;border-radius:8px;width:90%;max-width:700px;max-height:80vh;overflow:hidden;display:flex;flex-direction:column}.modal-header{padding:15px;border-bottom:1px solid #dee2e6;display:flex;justify-content:space-between;align-items:center}.modal-header h3{margin:0;font-size:1.1rem}.modal-close{background:none;border:none;font-size:20px;cursor:pointer;color:#6c757d;line-height:1}

.img-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px}@media(max-width:768px){.img-grid{grid-template-columns:1fr}}.img-preview-box{width:100%;height:200px;border:1px solid #ced4da;border-radius:5px;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#fff;margin:15px 0}.img-preview-box img{max-width:100%;max-height:100%;object-fit:contain}.range-group{margin:15px 0}.range-group label{display:block;margin-bottom:5px;font-weight:500;font-size:.85rem}input[type=range]{width:100%;accent-color:#000}
</style>
<div class="container"><header><h1>零刻</h1><p>结构化文字与视觉媒介的本地处理终端</p></header><div class="app-container"><div class="panel"><h2>输入TXT文件</h2><div class="upload-area" id="uploadArea"><i class="fas fa-cloud-upload-alt"></i><h3>点击上传TXT文件</h3><p>支持.txt格式，最大10MB</p><input type="file" id="txtFile" class="file-input" accept=".txt"></div><div class="config-section"><h3>转换配置</h3><div class="config-grid"><div class="config-item"><label for="bookTitle">书名：</label><input type="text" id="bookTitle" value="花与解剖刀" placeholder="请输入书名"></div><div class="config-item"><label for="author">作者：</label><input type="text" id="author" placeholder="请输入作者"></div><div class="config-item"><label for="chapterPrefix">章节前缀：</label><input type="text" id="chapterPrefix" value="第" placeholder="如:第、Chapter"></div><div class="config-item"><label for="chapterSuffix">章节后缀：</label><input type="text" id="chapterSuffix" value="章" placeholder="如:章、节"></div></div></div><textarea id="txtContent" placeholder="请上传TXT文件或在此粘贴文本内容..."></textarea><div class="control-panel"><button class="btn btn-primary" id="convertBtn">转换为JSON</button><button class="btn btn-secondary" id="clearBtn">清空</button><button class="btn btn-secondary" id="sampleBtn">示例</button></div></div><div class="panel"><h2>输出JSON</h2><div class="loading" id="loading"><div class="spinner"></div><p>正在处理中...</p></div><textarea id="jsonOutput" placeholder="JSON输出将显示在这里..." readonly></textarea><div class="stats" id="stats"><div class="stat-item"><div class="stat-value" id="chapterCount">0</div><div class="stat-label">章节数</div></div><div class="stat-item"><div class="stat-value" id="wordCount">0</div><div class="stat-label">总字数</div></div><div class="stat-item"><div class="stat-value" id="fileSize">0KB</div><div class="stat-label">文件大小</div></div></div><div class="control-panel"><button class="btn btn-success" id="downloadBtn" disabled>下载</button><button class="btn btn-secondary" id="copyBtn" disabled>复制</button><button class="btn btn-secondary" id="previewBtn" disabled>预览</button></div></div></div><div class="how-to-use"><h3>使用说明</h3><ol><li>上传TXT文件或直接粘贴文本内容</li><li>配置书名、作者等信息（可选）</li><li>点击"转换为JSON"按钮</li><li>从右侧输出区域下载或复制JSON文件</li></ol><div class="sample-format"><strong>支持的TXT格式示例：</strong><br><code>第一章 标题一<br>这里是第一章内容...<br><br>第二章 标题二<br>这里是第二章内容...</code></div></div><div class="footer"><p>✤ 世纪白昼 TXT转JSON转换器 | 离线文字结构重组</p></div></div><div class="notification" id="notification"><span id="notificationText">操作成功！</span></div><div id="previewModal"><div class="modal-content"><div class="modal-header"><h3>JSON预览</h3><button class="modal-close" id="closePreview">×</button></div><pre class="preview-area" id="previewContent"></pre></div></div>

<div class="app-container" style="margin-top:20px"><div class="panel"><h2>图片压缩配置</h2><div class="upload-area" id="imgUploadArea"><i class="fas fa-image"></i><h3>上传图片</h3><input type="file" id="imgInput" class="file-input" accept="image/*"></div><div class="config-section" style="border:none;margin:0;padding:0"><div class="range-group"><label>压缩强度: <span id="qualityVal">0.7</span></label><input type="range" id="qualityRange" min="0.01" max="0.95" step="0.01" value="0.7"></div><div class="range-group"><label>尺寸限制:</label><select id="maxWidth" style="width:100%;padding:6px;border-radius:4px;border:1px solid #ced4da"><option value="1920">1920px (高清)</option><option value="1280">1280px (标准)</option><option value="800">800px (小图)</option><option value="0">原始尺寸</option></select></div></div><button class="btn btn-primary" id="compressBtn" style="width:100%;justify-content:center;margin-top:10px">开始压缩</button></div><div class="panel"><h2>压缩预览</h2><div class="img-preview-box"><img id="sourcePreview" src="" style="display:none"><div id="imgPlaceholder" style="color:#6c757d">等待上传预览...</div></div><div class="stats" style="margin-bottom:15px"><div class="stat-item"><div class="stat-value" id="oldSize">0MB</div><div class="stat-label">原始大小</div></div><div class="stat-item"><div class="stat-value" id="newSize" style="color:#000">0MB</div><div class="stat-label">压缩后</div></div></div><div class="control-panel"><button class="btn btn-success" id="downloadImgBtn" disabled style="flex:1">下载压缩图片</button></div></div></div><div class="how-to-use" style="margin-top:20px"><h3>图片压缩说明</h3><ol><li>点击“上传图片”区域选择本地图片（支持 JPG、PNG、WebP 等）</li><li>调节“压缩强度”：数值越小体积越小，但画质会下降</li><li>选择“尺寸限制”：对于 100MB 以上的超大图，建议限制在 1920px 以内</li><li>点击“开始压缩”，等待预览区域出现大小统计后，即可点击下载</li></ol><div class="sample-format"><strong>提示：</strong>本工具完全在本地浏览器运行，图片不会上传到服务器，保护您的隐私安全。</div></div><div class="footer" style="margin-top:20px;border-top:1px dashed #dee2e6;padding-top:20px"><p>✤ 世纪白昼 图片尺寸压缩转换器 | 像素视觉无损复刻</p></div>

<div class="app-container" style="margin-top:20px"><div class="panel"><h2>图片转 URI 配置</h2><div class="upload-area" id="uriUploadArea"><i class="fas fa-link"></i><h3>上传图片</h3><p>获取 Base64 Data URI</p><input type="file" id="uriInput" class="file-input" accept="image/*"></div><div class="config-section" style="border:none;margin:0;padding:0"><p style="font-size:0.85rem;color:#666">URI 允许你将图片直接嵌入 HTML/CSS 代码中，无需外部文件。</p></div><button class="btn btn-primary" id="copyUriBtn" style="width:100%;justify-content:center;margin-top:10px" disabled>复制 URI 链接</button></div><div class="panel"><h2>URI 输出结果</h2><textarea id="uriOutput" placeholder="URI 字符串将在此显示..." readonly style="min-height:180px;font-size:10px"></textarea><div class="stats" style="margin-top:15px"><div class="stat-item"><div class="stat-value" id="uriCharCount">0</div><div class="stat-label">字符总数</div></div></div><div class="control-panel"><button class="btn btn-secondary" id="clearUriBtn" style="flex:1">清空</button></div></div></div><div class="how-to-use" style="margin-top:20px"><h3>URI 转换说明</h3><ol><li>选择图片后，系统会自动将其转换为 Base64 格式</li><li>点击“复制 URI 链接”即可直接用于 <code>&lt;img src="..."&gt;</code></li><li>注意：URI 会使体积增加约 33%，不建议用于超大图片</li></ol></div><div class="footer" style="margin-top:20px;border-top:1px dashed #dee2e6;padding-top:20px"><p>✤ 世纪白昼 图片URI转换工具 | 媒介字符化留存</p></div>
<script>
const uploadArea=document.getElementById('uploadArea'),txtFileInput=document.getElementById('txtFile'),txtContent=document.getElementById('txtContent'),jsonOutput=document.getElementById('jsonOutput'),convertBtn=document.getElementById('convertBtn'),clearBtn=document.getElementById('clearBtn'),downloadBtn=document.getElementById('downloadBtn'),copyBtn=document.getElementById('copyBtn'),previewBtn=document.getElementById('previewBtn'),sampleBtn=document.getElementById('sampleBtn'),loading=document.getElementById('loading'),notification=document.getElementById('notification'),notificationText=document.getElementById('notificationText'),previewModal=document.getElementById('previewModal'),previewContent=document.getElementById('previewContent'),closePreview=document.getElementById('closePreview'),bookTitleInput=document.getElementById('bookTitle'),authorInput=document.getElementById('author'),chapterPrefixInput=document.getElementById('chapterPrefix'),chapterSuffixInput=document.getElementById('chapterSuffix'),chapterCountEl=document.getElementById('chapterCount'),wordCountEl=document.getElementById('wordCount'),fileSizeEl=document.getElementById('fileSize');let currentJsonData=null;const sampleTxt=`第一章 sos，晴天霹雳的大乌龙\n电梯门合上的瞬间，那股令人窒息的失重感并没有如期而至，取而代之的是一阵尖锐得仿佛要撕裂灵魂的耳鸣。\n\n第二章 混乱的开始\n与此同时，上海市公安局刑侦总队，一辆疾驰的黑色SUV内。\n\n"纪队？纪队？"\n\n世纪白昼觉得自己做了一个很长的噩梦。梦里她变成了一块冰，被扔进了福尔马林池子里。`;uploadArea.addEventListener('click',()=>txtFileInput.click());txtFileInput.addEventListener('change',handleFileUpload);convertBtn.addEventListener('click',convertToJson);clearBtn.addEventListener('click',clearAll);downloadBtn.addEventListener('click',downloadJson);copyBtn.addEventListener('click',copyToClipboard);previewBtn.addEventListener('click',previewJson);sampleBtn.addEventListener('click',loadSample);closePreview.addEventListener('click',()=>previewModal.style.display='none');function handleFileUpload(e){const f=e.target.files[0];if(!f)return;if(!f.name.endsWith('.txt')){showNotification('请选择.txt文件','error');return}if(f.size>10*1024*1024){showNotification('文件不能超过10MB','error');return}const r=new FileReader();r.onload=function(e){txtContent.value=e.target.result;showNotification('文件加载成功','success')};r.onerror=function(){showNotification('文件读取失败','error')};r.readAsText(f,'UTF-8')}function loadSample(){txtContent.value=sampleTxt;bookTitleInput.value='花与解剖刀';authorInput.value='作者名';showNotification('示例内容已加载','success')}function clearAll(){txtContent.value='';jsonOutput.value='';txtFileInput.value='';currentJsonData=null;updateStats(0,0,0);setButtonStates(false);showNotification('已清空','success')}function convertToJson(){const t=txtContent.value.trim();if(!t){showNotification('请输入内容','error');return}showLoading(true);setTimeout(()=>{try{const b=bookTitleInput.value||'未命名书籍',a=authorInput.value||'',p=chapterPrefixInput.value||'第',s=chapterSuffixInput.value||'章',c=parseChapters(t,p,s),w=c.reduce((s,ch)=>s+ch.wordCount,0);currentJsonData={version:"1.0",exportDate:new Date().toISOString(),bookTitle:b,author:a,chapters:c,chapterCount:c.length,totalWordCount:w};jsonOutput.value=JSON.stringify(currentJsonData,null,2);updateStats(c.length,w,jsonOutput.value.length);setButtonStates(true);showNotification('转换成功！','success')}catch(e){showNotification('转换失败','error')}finally{showLoading(false)}},800)}function parseChapters(t,p,s){const r=new RegExp(`(?=\\s*${p}[0-9一二三四五六七八九十零百千万]+${s}\\s+[^\\n]+)`,'g');let a=t.split(r);if(a.length<=1)return[{title:"第一章",content:t,wordCount:countWords(t),generatedAt:new Date().toISOString(),chapterIndex:0}];if(a[0].trim()==='')a=a.slice(1);const c=[];let i=0;for(let n=0;n<a.length;n++){const p=a[n].trim();if(!p)continue;const l=p.split('\n'),ti=l[0].trim();let co=l.slice(1).join('\n').trim();if(!co&&l.length===1)continue;c.push({title:ti,content:co,wordCount:countWords(co),generatedAt:new Date().toISOString(),chapterIndex:i});i++}return c}function countWords(t){const c=t.replace(/\s/g,'').match(/[\u4e00-\u9fa5]/g);return c?c.length:0}function updateStats(c,w,s){chapterCountEl.textContent=c;wordCountEl.textContent=w.toLocaleString();fileSizeEl.textContent=`${Math.round(s/1024)}KB`}function setButtonStates(e){downloadBtn.disabled=!e;copyBtn.disabled=!e;previewBtn.disabled=!e;if(e){downloadBtn.classList.remove('btn-secondary');downloadBtn.classList.add('btn-success')}else{downloadBtn.classList.add('btn-secondary');downloadBtn.classList.remove('btn-success')}}function showLoading(s){loading.style.display=s?'block':'none';convertBtn.disabled=s}function showNotification(m,ty='success'){notificationText.textContent=m;notification.className=`notification ${ty} show`;setTimeout(()=>notification.classList.remove('show'),3000)}function downloadJson(){if(!currentJsonData)return;const j=JSON.stringify(currentJsonData,null,2),b=new Blob([j],{type:'application/json'}),u=URL.createObjectURL(b),a=document.createElement('a');a.href=u;a.download=`${bookTitleInput.value||'book'}_${new Date().toISOString().split('T')[0]}.json`;a.click();URL.revokeObjectURL(u);showNotification('下载成功','success')}function copyToClipboard(){if(!jsonOutput.value)return;navigator.clipboard.writeText(jsonOutput.value).then(()=>showNotification('已复制','success'))}function previewJson(){if(!currentJsonData)return;previewContent.textContent=JSON.stringify(currentJsonData,null,2);previewModal.style.display='flex'}function init(){bookTitleInput.value='花与解剖刀';updateStats(0,0,0);setButtonStates(false);showNotification('欢迎使用！','success')}document.addEventListener('DOMContentLoaded',init);

const imgInput=document.getElementById('imgInput'),imgUploadArea=document.getElementById('imgUploadArea'),sourcePreview=document.getElementById('sourcePreview'),imgPlaceholder=document.getElementById('imgPlaceholder'),qualityRange=document.getElementById('qualityRange'),qualityVal=document.getElementById('qualityVal'),compressBtn=document.getElementById('compressBtn'),downloadImgBtn=document.getElementById('downloadImgBtn'),oldSizeEl=document.getElementById('oldSize'),newSizeEl=document.getElementById('newSize'),maxWidthSelect=document.getElementById('maxWidth');let originalFile=null,compressedBlob=null;imgUploadArea.onclick=()=>imgInput.click();imgInput.onchange=function(e){const f=e.target.files[0];if(!f)return;originalFile=f;oldSizeEl.textContent=(f.size/(1024*1024)).toFixed(2)+'MB';const r=new FileReader();r.onload=(ev)=>{sourcePreview.src=ev.target.result;sourcePreview.style.display='block';imgPlaceholder.style.display='none'};r.readAsDataURL(f)};qualityRange.oninput=(e)=>qualityVal.textContent=e.target.value;compressBtn.onclick=function(){if(!originalFile){showNotification('请先上传图片','error');return}const r=new FileReader();r.readAsDataURL(originalFile);r.onload=function(e){const i=new Image();i.src=e.target.result;i.onload=function(){const c=document.createElement('canvas');let w=i.width,h=i.height,m=parseInt(maxWidthSelect.value);if(m>0&&w>m){const ra=m/w;w=m;h=h*ra}c.width=w;c.height=h;const ctx=c.getContext('2d');ctx.drawImage(i,0,0,w,h);c.toBlob((b)=>{compressedBlob=b;newSizeEl.textContent=(b.size/(1024*1024)).toFixed(2)+'MB';downloadImgBtn.disabled=false;showNotification('图片已生成','success')},'image/jpeg',parseFloat(qualityRange.value))}}};downloadImgBtn.onclick=function(){if(!compressedBlob)return;const l=document.createElement('a');l.href=URL.createObjectURL(compressedBlob);l.download=`compressed_${originalFile.name.split('.')[0]}.jpg`;l.click()};

const uriInput=document.getElementById('uriInput'),uriUploadArea=document.getElementById('uriUploadArea'),uriOutput=document.getElementById('uriOutput'),copyUriBtn=document.getElementById('copyUriBtn'),clearUriBtn=document.getElementById('clearUriBtn'),uriCharCount=document.getElementById('uriCharCount');uriUploadArea.onclick=()=>uriInput.click();uriInput.onchange=function(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(ev){const s=ev.target.result;uriOutput.value=s;uriCharCount.textContent=s.length.toLocaleString();copyUriBtn.disabled=false;showNotification('URI 转换完成','success')};r.readAsDataURL(f)};copyUriBtn.onclick=function(){if(!uriOutput.value)return;navigator.clipboard.writeText(uriOutput.value).then(()=>showNotification('URI 已复制到剪贴板','success'))};clearUriBtn.onclick=function(){uriInput.value='';uriOutput.value='';uriCharCount.textContent='0';copyUriBtn.disabled=true;showNotification('已清空','success')};
</script>
</body>
</html>